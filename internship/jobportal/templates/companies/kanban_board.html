{% extends 'companies/base.html' %}

{% block content %}
<div class="container-fluid" style="padding: 20px;">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Applicants for <span class="text-primary">{{ job.title }}</span></h2>
        <a href="{% url 'company_dashboard' %}" class="btn btn-outline-secondary">Back to Dashboard</a>
    </div>
    
    <div class="row flex-nowrap overflow-auto" style="min-height: 70vh;">
        
        <div class="col-md-3">
            <div class="card bg-light h-100">
                <div class="card-header bg-primary text-white font-weight-bold">
                    Applied 
                    <span class="badge badge-light float-right" style="background: white; color: #007bff; border-radius: 50%;">
                        {{ applicants|length }}
                    </span>
                </div>
                <div class="card-body" id="applied" style="overflow-y: auto;">
                    {% for app in applicants %}
                        {% if app.status == 'applied' or app.status == 'Pending' %}
                            <div class="card mb-2 shadow-sm border-left-primary">
                                <div class="card-body p-3">
                                    <div class="d-flex justify-content-between">
                                        <h6 class="font-weight-bold" style="margin:0;">{{ app.user.first_name }} {{ app.user.last_name }}</h6>
                                        
                                        {% if app.match_score >= 70 %}
                                            <span class="badge bg-success text-white" title="Excellent Match">{{ app.match_score }}%</span>
                                        {% elif app.match_score >= 40 %}
                                            <span class="badge bg-warning text-dark" title="Good Match">{{ app.match_score }}%</span>
                                        {% else %}
                                            <span class="badge bg-danger text-white" title="Low Match">{{ app.match_score }}%</span>
                                        {% endif %}
                                    </div>
                                    
                                    <p class="small text-muted mb-2" style="font-size: 0.85rem;">{{ app.user.email }}</p>
                                    
                                    <div class="d-flex justify-content-between mt-2 align-items-center">
                                        <a href="#" class="btn btn-sm btn-outline-primary" style="font-size: 0.75rem;">View Profile</a>
                                        <small class="text-muted">{{ app.applied_at|date:"M d" }}</small>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card bg-light h-100">
                <div class="card-header bg-warning text-dark font-weight-bold">Interview</div>
                <div class="card-body" id="interview" style="overflow-y: auto;">
                    {% for app in applicants %}
                        {% if app.status == 'interview' %}
                            <div class="card mb-2 shadow-sm">
                                <div class="card-body p-3">
                                    <div class="d-flex justify-content-between">
                                        <h6 class="font-weight-bold">{{ app.user.first_name }}</h6>
                                        <span class="badge bg-secondary">{{ app.match_score }}%</span>
                                    </div>
                                    <p class="small text-muted mb-0">Interview Scheduled</p>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card bg-light h-100">
                <div class="card-header bg-success text-white font-weight-bold">Selected</div>
                <div class="card-body" id="selected" style="overflow-y: auto;">
                    {% for app in applicants %}
                        {% if app.status == 'selected' or app.status == 'hired' %}
                            <div class="card mb-2 shadow-sm border-left-success">
                                <div class="card-body p-3">
                                    <h6 class="font-weight-bold">{{ app.user.first_name }} {{ app.user.last_name }}</h6>
                                    <span class="badge badge-success w-100 mt-1">HIRED</span>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="card bg-light h-100">
                <div class="card-header bg-danger text-white font-weight-bold">Rejected</div>
                <div class="card-body" id="rejected" style="overflow-y: auto;">
                    {% for app in applicants %}
                        {% if app.status == 'rejected' %}
                            <div class="card mb-2 shadow-sm" style="opacity: 0.7;">
                                <div class="card-body p-3">
                                    <h6 class="text-muted">{{ app.user.first_name }}</h6>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>

    </div>
</div>

<style>
    /* Optional: Custom Scrollbar for columns */
    .card-body::-webkit-scrollbar {
        width: 6px;
    }
    .card-body::-webkit-scrollbar-thumb {
        background-color: rgba(0,0,0,0.2);
        border-radius: 4px;
    }
    .border-left-primary { border-left: 4px solid #007bff; }
    .border-left-success { border-left: 4px solid #28a745; }
</style>
{% endblock %}