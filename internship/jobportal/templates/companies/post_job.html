{% extends 'companies/base.html' %}
{% load static %}

{% block content %}
<style>
    :root {
        --primary: #0d6efd;
        --primary-dark: #0a58ca;
        --bg-body: #f3f2ef;
        --text-main: #191919;
        --text-muted: #666;
        --border: #e0e0e0;
    }

    body {
        background-color: var(--bg-body);
        font-family: 'Inter', sans-serif;
    }

    /* --- Page Wrapper --- */
    .page-wrapper {
        max-width: 1150px;
        margin: 30px auto;
        padding: 0 20px;
    }

    /* --- Top Header Card --- */
    .header-card {
        background: white;
        border-radius: 12px;
        padding: 25px 30px;
        display: flex;
        align-items: center;
        gap: 20px;
        border: 1px solid var(--border);
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        margin-bottom: 25px;
    }

    .header-logo {
        width: 55px; height: 55px;
        object-fit: contain;
        border-radius: 8px;
        border: 1px solid #eee;
        padding: 4px;
    }

    .header-info h2 { margin: 0; font-size: 1.4rem; font-weight: 700; color: var(--text-main); }
    .header-info p { margin: 2px 0 0; color: var(--text-muted); font-size: 0.9rem; }

    /* --- Main Layout Grid --- */
    .form-layout {
        display: grid;
        grid-template-columns: 1fr 360px; /* Content | Sidebar */
        gap: 25px;
        align-items: start;
    }

    /* --- Content Cards --- */
    .content-card {
        background: white;
        border-radius: 12px;
        padding: 35px;
        border: 1px solid var(--border);
        box-shadow: 0 2px 8px rgba(0,0,0,0.03);
        margin-bottom: 20px;
    }

    .section-head {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--text-main);
        margin-bottom: 25px;
        padding-bottom: 10px;
        border-bottom: 2px solid #f3f3f3;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .section-head i { color: var(--primary); }

    /* --- Input Styles --- */
    .form-group { margin-bottom: 20px; }
    
    label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        font-size: 0.9rem;
        color: #4b5563;
    }

    .form-control, .form-select {
        width: 100%;
        padding: 12px 15px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        font-size: 0.95rem;
        background-color: #fff;
        transition: all 0.2s;
        box-sizing: border-box;
    }

    .form-control:focus, .form-select:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(13, 110, 253, 0.1);
    }

    textarea.form-control { resize: vertical; line-height: 1.6; }

    /* --- Sidebar Styling --- */
    .sidebar-card {
        background: white;
        border-radius: 12px;
        padding: 25px;
        border: 1px solid var(--border);
        box-shadow: 0 4px 12px rgba(0,0,0,0.06);
        position: sticky;
        top: 80px; 
    }

    /* --- TOGGLE SWITCH DESIGN (The "Onside Button") --- */
    .toggle-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 15px 0;
        border-bottom: 1px solid #f0f0f0;
    }
    .toggle-row:last-of-type { border-bottom: none; }

    .toggle-text {
        display: flex;
        flex-direction: column;
    }
    .toggle-text span { font-weight: 600; font-size: 0.95rem; color: #333; }
    .toggle-text small { font-size: 0.8rem; color: #888; }

    /* The Switch Container */
    .switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 28px;
    }

    /* Hide default HTML checkbox */
    .switch input { 
        opacity: 0;
        width: 0;
        height: 0;
    }

    /* The Slider */
    .slider {
        position: absolute;
        cursor: pointer;
        top: 0; left: 0; right: 0; bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 34px;
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 22px;
        width: 22px;
        left: 3px;
        bottom: 3px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    input:checked + .slider {
        background-color: var(--primary);
    }

    input:focus + .slider {
        box-shadow: 0 0 1px var(--primary);
    }

    input:checked + .slider:before {
        transform: translateX(22px);
    }

    /* --- Action Buttons --- */
    .btn-submit {
        background-color: var(--primary);
        color: white;
        width: 100%;
        padding: 14px;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        margin-top: 20px;
        transition: 0.2s;
        box-shadow: 0 4px 10px rgba(13, 110, 253, 0.3);
    }
    .btn-submit:hover { background-color: var(--primary-dark); transform: translateY(-2px); }

    /* Mobile Responsive */
    @media (max-width: 900px) {
        .form-layout { grid-template-columns: 1fr; }
        .sidebar-card { position: relative; top: 0; order: -1; margin-bottom: 20px; }
    }
</style>

<div class="page-wrapper">
    
    <div class="header-card">
        {% if company.logo %}
            <img src="{{ company.logo.url }}" class="header-logo">
        {% else %}
            <div class="header-logo" style="display:flex; justify-content:center; align-items:center; background:#f8f9fa;">
                <i class="fas fa-building text-muted"></i>
            </div>
        {% endif %}
        <div class="header-info">
            <h2>Create Job Post</h2>
            <p>Publishing for <strong>{{ company.company_name }}</strong></p>
        </div>
    </div>

    <form method="POST" id="jobForm">
        {% csrf_token %}
        
        <div class="form-layout">
            
            <div class="main-column">
                
                <div class="content-card">
                    <div class="section-head"><i class="fas fa-edit"></i> Job Details</div>
                    
                    <div class="form-group">
                        <label>Job Title <span style="color:red">*</span></label>
                        {{ form.title }}
                    </div>

                    <div class="form-group">
                        <label>Job Description <span style="color:red">*</span></label>
                        {{ form.description }}
                    </div>

                    <div class="form-group">
                        <label>Key Skills (comma-separated)</label>
                        {{ form.skills }}
                        <small style="color:#666; font-size:0.85rem;">e.g. Python, Django, React, JavaScript</small>
                    </div>
                </div>

                <div class="content-card">
                    <div class="section-head"><i class="fas fa-list-check"></i> Specifics</div>
                    
                    <div class="form-group">
                        <label>Key Requirements (Bullet points)</label>
                        {{ form.requirements }}
                    </div>

                    <div class="form-group">
                        <label>Benefits & Perks</label>
                        {{ form.benefits }}
                    </div>
                </div>

            </div>

            <div class="sidebar-column">
                <div class="sidebar-card">
                    <div class="section-head" style="font-size:1rem; margin-bottom:20px;">
                        <i class="fas fa-cog"></i> Job Configuration
                    </div>

                    <div class="form-group">
                        <label>Location</label>
                        {{ form.location }}
                    </div>

                    <div class="form-group">
                        <label>Employment Type</label>
                        {{ form.job_type }}
                    </div>

                    <label style="margin-top:10px;">Salary Range ($)</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                        {{ form.salary_min }}
                        {{ form.salary_max }}
                    </div>

                    <hr style="border:0; border-top:1px solid #eee; margin: 20px 0;">

                    <div class="toggle-row">
                        <div class="toggle-text">
                            <span>Remote Work</span>
                            <small>Fully remote allowed?</small>
                        </div>
                        <label class="switch">
                            {{ form.is_remote }}
                            <span class="slider"></span>
                        </label>
                    </div>

                    <div class="toggle-row">
                        <div class="toggle-text">
                            <span>Urgent Hiring</span>
                            <small>Boost visibility?</small>
                        </div>
                        <label class="switch">
                            {{ form.is_urgent }}
                            <span class="slider"></span>
                        </label>
                    </div>

                    <button type="submit" class="btn-submit" id="submitBtn">
                        Publish Job
                    </button>

                </div>
            </div>

        </div>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 1. Add 'form-control' class to standard Django inputs
        const inputs = document.querySelectorAll('input[type="text"], input[type="number"], select, textarea');
        inputs.forEach(input => input.classList.add('form-control'));

        // 2. IMPORTANT: Do NOT add 'form-control' to the toggle checkboxes
        // The HTML structure above {{ form.is_remote }} handles the styling automatically
        // thanks to the wrapping <label class="switch">

        // 3. Auto-Resize Textareas
        const textareas = document.querySelectorAll('textarea');
        textareas.forEach(textarea => {
            textarea.style.overflow = 'hidden';
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });
        });

        // 4. Loading State
        const form = document.getElementById('jobForm');
        form.addEventListener('submit', function() {
            const btn = document.getElementById('submitBtn');
            btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Publishing...';
            btn.style.opacity = '0.7';
            btn.style.pointerEvents = 'none';
        });
    });
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}